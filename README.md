# Конструктор боя для гитары

Интерактивный конструктор музыкальных боёв для гитары с визуализацией стрелок, воспроизведением звуков и поддержкой аккордовых прогрессий.

## Описание

Конструктор боя - это современное веб-приложение, позволяющее создавать, редактировать и воспроизводить музыкальные бои для гитары. Приложение предоставляет интуитивный интерфейс для визуализации боёв с помощью стрелок вверх/вниз, генерации звуков ударов по струнам с помощью Web Audio API, настройки темпа и использования аккордовых прогрессий.

## Основные возможности

- **Визуализация боёв**: Интерактивное отображение стрелок вверх/вниз с возможностью выбора активных ударов
- **Гибкая настройка**: Поддержка различных количеств долей (4, 8, 16) для разных стилей игры
- **Воспроизведение звуков**: Реалистичные звуки ударов по гитарным струнам, генерируемые программно с помощью Web Audio API
- **Аккордовые прогрессии**: Поддержка аккордовых последовательностей с автоматическим подбором высоты звуков
- **Настройка темпа**: Регулировка BPM от 40 до 200 и выбор скорости воспроизведения (50%, 75%, 100%, 125%)
- **Экспорт данных**: Экспорт боёв в форматах PNG (визуализация) и JSON (данные)
- **Генерация случайных боёв**: Автоматическое создание боёв с заданными параметрами

## Структура проекта

```
guitar-combat/
├── index.html              # Основная HTML-страница приложения
├── package.json           # Конфигурация проекта и зависимости
├── tailwind.config.js     # Конфигурация Tailwind CSS
├── css/
│   ├── input.css         # Исходные стили Tailwind
│   └── styles.css        # Скомпилированные стили
├── js/
│   ├── main.js           # Точка входа приложения
│   ├── roadmap.md        # Дорожная карта реализации звуков
│   ├── roadmap-detailed.md # Подробная дорожная карта метронома
│   ├── components/       # Компоненты приложения
│   │   ├── BeatRow.js    # Компонент визуализации стрелок
│   │   ├── Controls.js   # Компонент управления параметрами
│   │   ├── Metronome.js  # Компонент воспроизведения звуков
│   │   ├── ChordManager.js # Компонент управления аккордами
│   │   └── Playback.js   # Компонент управления воспроизведением
│   └── utils/            # Вспомогательные утилиты
│       └── ExportUtils.js # Утилиты экспорта данных
└── README.md             # Документация проекта
```

## Компоненты приложения

### BeatRow.js - Компонент визуализации стрелок

Отвечает за отображение и взаимодействие с визуальным представлением боя:
- Отображение стрелок вверх/вниз с SVG-графикой
- Управление активными/неактивными битами через кликабельные кружки
- Адаптивная визуализация под разное количество битов (4, 8, 16)
- Подсветка текущей позиции воспроизведения
- Обработка кликов по стрелкам для ручной навигации

### Controls.js - Компонент управления

Предоставляет интерфейс для настройки параметров боя:
- Выбор количества долей (4/8/16 кнопки)
- Генерация случайных боёв с предустановленными правилами
- Настройка BPM через числовое поле ввода
- Выбор скорости воспроизведения из выпадающего списка
- Обновление визуального состояния элементов управления

### Metronome.js - Компонент воспроизведения звуков

Сердце звуковой системы приложения, использующее Web Audio API:
- Инициализация и управление Web Audio Context
- Генерация реалистичных звуков ударов по гитарным струнам
- Синхронизация звуков с визуальной подсветкой стрелок
- Поддержка аккордовых прогрессий через ChordManager
- Планирование звуков вперед для плавного воспроизведения
- Настройка темпа (BPM) и синхронизация с интерфейсом

### ChordManager.js - Компонент управления аккордами

Управляет аккордовыми прогрессиями и их звуковым сопровождением:
- Хранение словаря аккордов с частотами нот (Am, A, Dm, D, Em, E, G, C, F, B, Bm, F#m)
- Парсинг строк аккордов из текстового ввода
- Сопоставление аккордов с долями боя
- Получение частот нот для каждого аккорда
- Валидация существующих аккордов

### Playback.js - Компонент управления воспроизведением

Координирует процесс воспроизведения боя:
- Управление состоянием Play/Pause
- Синхронизация с компонентом Metronome
- Обновление состояния кнопки воспроизведения
- Установка текущей позиции воспроизведения
- Обработка событий начала и остановки воспроизведения

### ExportUtils.js - Утилиты экспорта

Предоставляет функции для сохранения результатов работы:
- Экспорт визуализации в PNG формат с помощью html2canvas
- Экспорт данных боя в JSON формат
- Автоматическая генерация имен файлов с временной меткой
- Сбор всех параметров боя для экспорта (BPM, скорость, аккорды)

## Использование

1. **Запуск приложения**:
   ```bash
   # Установка зависимостей (если не установлен Tailwind)
   npm install
   
   # Запуск локального сервера для разработки
   python -m http.server 8000
   # или
   npx http-server
   ```

2. **Работа с интерфейсом**:
   - Выберите количество долей (4/8/16) для настройки сложности боя
   - Кликайте по кружкам под стрелками для активации/деактивации ударов
   - Используйте кнопку "Сгенерировать" для создания случайного боя
   - Настройте BPM и скорость воспроизведения под свои предпочтения
   - Введите аккордовую прогрессию в формате "Am | F | Dm | E"
   - Нажмите "Play" для воспроизведения боя с синхронизацией звука и визуализации
   - Экспортируйте результат в PNG или JSON по необходимости

## Зависимости

- **Tailwind CSS** - для стилизации интерфейса
- **html2canvas** (CDN) - для экспорта визуализации в PNG
- **Web Audio API** - для генерации звуков (встроено в браузер)

## Архитектура и особенности реализации

### Звуковая система
Проект использует Web Audio API для программной генерации звуков ударов по гитарным струнам:
- Создание богатого тембра с помощью комбинации осцилляторов
- Реализация огибающей ADSR для естественного звучания
- Фильтрация для создания гитарного тембра
- Синхронизация со визуальной подсветкой стрелок

### Система аккордов
- Поддержка 12 основных аккордов с предустановленными частотами
- Парсинг аккордовых прогрессий из текстового ввода
- Автоматическое сопоставление аккордов с долями боя
- Генерация гармоничных звуков для активных стрелочек

### Метроном и синхронизация
- Точная синхронизация звуков и визуализации
- Планирование звуков вперед для плавного воспроизведения
- Поддержка различных темпов и скоростей
- Адаптивная система подсветки для разных количеств долей

## Разработка

Проект использует нативные ES6 модули, поэтому для корректной работы необходим локальный сервер:

```bash
# Разработка с Tailwind CSS
npm run dev  # Запуск watcher для CSS

# Сборка CSS
npm run build:css
```

## Возможные улучшения

- **Сохранение/загрузка боёв**: Локальное хранилище или серверная интеграция
- **Расширенная библиотека аккордов**: Добавление мажорных, минорных и септаккордов
- **Визуальные эффекты**: Анимации и улучшенная графика
- **Расширение звуковой библиотеки**: Добавление различных тембров и эффектов
- **Пользовательские пресеты**: Сохранение любимых настроек
- **Редактор аккордовых прогрессий**: Визуальный интерфейс для создания прогрессий
- **Обучение и галерея**: Дополнительные разделы для изучения и демонстрации

## Лицензия

MIT

## Автор

Проект разработан как MVP (Minimum Viable Product) для демонстрации возможностей современных веб-технологий в музыкальном образовании.
